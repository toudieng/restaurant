{% extends 'client/base.html' %}
{% load static %}
{% load restaurant_app_extras %}

{% block title %}Votre panier{% endblock %}

{% block content %}
<main class="container mt-5 pt-5">
    <h2>Votre Panier</h2>
    {% if panier %}
    <table class="table">
        <thead>
            <tr>
                <th>Produit</th>
                <th>Quantité</th>
                <th>Prix unitaire</th>
                <th>Total</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for plat_id, item in panier.items %}
            <tr>
                <td>{{ item.nom }}</td>
                <td>
                    <form action="{% url 'modifier_quantite' plat_id=plat_id %}" method="post" class="d-flex">
                        {% csrf_token %}
                        <input type="number" name="quantite" value="{{ item.quantite }}" min="1" class="form-control me-2" style="width: 80px;">
                        <button type="submit" class="btn btn-sm btn-outline-secondary">Mettre à jour</button>
                    </form>
                </td>
                <td>{{ item.prix }} F CFA</td>
                <td>{{ item.total }} F CFA</td>
                <td>
                    <a href="{% url 'supprimer_du_panier' plat_id=plat_id %}" class="btn btn-danger btn-sm">Supprimer</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="d-flex justify-content-between align-items-center mt-4">
        <h4>Total du Panier :</h4>
        <h4><strong>{{ total_panier }} F CFA</strong></h4>
    </div>

    <div class="mt-4 d-flex justify-content-between">
        <a href="{% url 'menu' %}" class="btn btn-outline-secondary">← Retour au menu</a>
        <a href="{% url 'validation_commande' %}" class="btn btn-primary btn-lg">Passer à la commande</a>
    </div>

    {% else %}
    <div class="alert alert-info">
        Votre panier est vide. <a href="{% url 'menu' %}">Retourner au menu</a>.
    </div>
    {% endif %}
</main>
{% endblock %}
