{% extends 'client/base.html' %}

{% block title %}Confirmation de Commande{% endblock %}

{% block content %}
<main class="container mt-5">
    <div class="card shadow-sm mx-auto" style="max-width: 600px;">
        <div class="card-body text-center">
            {% if paiement_ok %}
                <h3 class="card-title text-success mb-3">Paiement Réussi !</h3>
                <p class="card-text lead">Votre commande <span class="fw-bold">#{{ commande.id }}</span> a été enregistrée avec succès et votre paiement a été confirmé.</p>
            {% elif paiement_en_attente %}
                <h3 class="card-title text-warning mb-3">Commande Enregistrée - Paiement en Attente</h3>
                <p class="card-text lead">Votre commande <span class="fw-bold">#{{ commande.id }}</span> a été enregistrée.</p>
                <p class="card-text">Veuillez effectuer le paiement en espèces auprès du caissier. Votre commande passera en préparation une fois le paiement validé.</p>
            {% else %}
                <h3 class="card-title text-info mb-3">Commande Enregistrée</h3>
                <p class="card-text lead">Votre commande <span class="fw-bold">#{{ commande.id }}</span> a été enregistrée.</p>
                <p class="card-text">Vous pouvez suivre son statut dans la section "Mes Commandes".</p>
            {% endif %}

            <hr>
            <p class="mb-2"><strong>Mode de commande :</strong> {{ commande.get_mode_commande_display }}</p>
            {% if commande.mode_commande == 'livraison' %}
                <p class="mb-2"><strong>Adresse de livraison :</strong> {{ commande.adresse_livraison }}</p>
                <p class="mb-2"><strong>Téléphone :</strong> {{ commande.telephone }}</p>
            {% else %}
                {% if commande.reservation %}
                    <p class="mb-2"><strong>Réservation :</strong> {{ commande.reservation.date_reservation }} à {{ commande.reservation.heure_reservation }}</p>
                {% else %}
                    <p class="mb-2 text-muted">Aucune réservation associée (commande sur place sans réservation spécifique).</p>
                {% endif %}
            {% endif %}
            <p class="mb-4"><strong>Total :</strong> {{ commande.total_paiement }} F CFA</p>

            <a href="{% url 'mes_commandes' %}" class="btn btn-primary me-2">Voir mes commandes</a>
            <a href="{% url 'menu' %}" class="btn btn-secondary">Retour au menu</a>

            <a href="{% url 'generer_facture_pdf' commande.id %}" class="btn btn-success ms-2" target="_blank">
                <i class="fas fa-file-pdf"></i> Enregistrer la facture en PDF
            </a>
            
        </div>
    </div>
</main>
{% endblock %}